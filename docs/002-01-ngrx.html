<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-12T13:30:42.382258"><title>Module 2 : Pour aller plus loin - Introduction &agrave; NgRx (L'approche Redux) | Angular avancé</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction","level":0,"title":"Introduction","anchor":"#introduction"},{"id":"la-philosophie-de-ngrx","level":0,"title":"La Philosophie de NgRx","anchor":"#la-philosophie-de-ngrx"},{"id":"les-acteurs-de-ngrx","level":0,"title":"Les Acteurs de NgRx","anchor":"#les-acteurs-de-ngrx"},{"id":"le-flux-de-donn-es-unidirectionnel","level":0,"title":"Le Flux de Données Unidirectionnel","anchor":"#le-flux-de-donn-es-unidirectionnel"},{"id":"atelier-pratique-refactoriser-la-liste-d-utilisateurs-avec-ngrx","level":0,"title":"Atelier Pratique : Refactoriser la Liste d\u0027Utilisateurs avec NgRx","anchor":"#atelier-pratique-refactoriser-la-liste-d-utilisateurs-avec-ngrx"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 2 : Pour aller plus loin - Introduction &agrave; NgRx (L'approche Redux) | Angular avancé"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Angular avancé Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/002-01-ngrx.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 2 : Pour aller plus loin - Introduction &agrave; NgRx (L'approche Redux) | Angular avancé"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/002-01-ngrx.html#webpage",
    "url": "writerside-documentation/002-01-ngrx.html",
    "name": "Module 2 : Pour aller plus loin - Introduction &agrave; NgRx (L'approche Redux) | Angular avancé",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Angular avancé Help"
}</script><!-- End Schema.org --></head><body data-id="002-01-ngrx" data-main-title="Module 2 : Pour aller plus loin - Introduction à NgRx (L'approche Redux)" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="002-00-state-management.md|Module 2 : L'essentiel - Stratégies de Gestion d'État (State Management)"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Angular avancé  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="002-01-ngrx" id="002-01-ngrx.md">Module 2 : Pour aller plus loin - Introduction à NgRx (L'approche Redux)</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs p&eacute;dagogiques</h2><p id="-vr9d5t_11">&Agrave; la fin de cette partie, vous serez capable de :</p><ul class="list _bullet" id="-vr9d5t_12"><li class="list__item" id="-vr9d5t_13"><p id="-vr9d5t_17"><span class="control" id="-vr9d5t_18">Comprendre</span> la philosophie derri&egrave;re NgRx : &eacute;tat unique, immuable et flux de donn&eacute;es unidirectionnel.</p></li><li class="list__item" id="-vr9d5t_14"><p id="-vr9d5t_19"><span class="control" id="-vr9d5t_20">Distinguer</span> le r&ocirc;le de chaque acteur principal de NgRx : <code class="code" id="-vr9d5t_21">Store</code>, <code class="code" id="-vr9d5t_22">Actions</code>, <code class="code" id="-vr9d5t_23">Reducers</code>, <code class="code" id="-vr9d5t_24">Effects</code>, et <code class="code" id="-vr9d5t_25">Selectors</code>.</p></li><li class="list__item" id="-vr9d5t_15"><p id="-vr9d5t_26"><span class="control" id="-vr9d5t_27">Mettre en &oelig;uvre</span> un cycle complet de gestion d'&eacute;tat avec NgRx : de l'action de l'utilisateur &agrave; la mise &agrave; jour de la vue.</p></li><li class="list__item" id="-vr9d5t_16"><p id="-vr9d5t_28"><span class="control" id="-vr9d5t_29">Refactoriser</span> une fonctionnalit&eacute; existante pour utiliser NgRx.</p></li></ul></section><section class="chapter"><h2 id="introduction" data-toc="introduction">Introduction</h2><p id="-vr9d5t_30">Le service &quot;stateful&quot; que nous avons construit est un outil fantastique. C'est votre couteau suisse : polyvalent, simple et efficace pour de nombreuses situations. Mais que se passe-t-il lorsque vous ne construisez plus une cabane, mais un gratte-ciel ? Quand plusieurs &eacute;quipes d'artisans doivent travailler en m&ecirc;me temps, chacune sur un &eacute;tage diff&eacute;rent, tout en s'assurant que la plomberie et l'&eacute;lectricit&eacute; restent coh&eacute;rentes dans tout le b&acirc;timent ?</p><p id="-vr9d5t_31">C'est l&agrave; que le couteau suisse montre ses limites. Vous avez besoin d'un plan d'architecte d&eacute;taill&eacute;, d'un cahier des charges strict et de processus clairs. <span class="control" id="-vr9d5t_35">NgRx est ce plan d'architecte.</span></p><p id="-vr9d5t_32">Inspir&eacute; par la biblioth&egrave;que Redux de l'&eacute;cosyst&egrave;me React, NgRx apporte un cadre tr&egrave;s structur&eacute; pour la gestion d'&eacute;tat. Sa courbe d'apprentissage est plus raide, et il demande plus de code au d&eacute;part (&quot;boilerplate&quot;). Alors pourquoi l'utiliser ? Pour trois raisons fondamentales qui deviennent cruciales dans les grandes applications :</p><ol class="list _decimal" id="-vr9d5t_33" type="1"><li class="list__item" id="-vr9d5t_36"><p id="-vr9d5t_39"><span class="control" id="-vr9d5t_40">Pr&eacute;visibilit&eacute; :</span> Les changements d'&eacute;tat deviennent extr&ecirc;mement pr&eacute;visibles, car ils doivent suivre un chemin strict et unique.</p></li><li class="list__item" id="-vr9d5t_37"><p id="-vr9d5t_41"><span class="control" id="-vr9d5t_42">Maintenabilit&eacute; :</span> Le code est d&eacute;coup&eacute; en petites unit&eacute;s logiques (actions, reducers, effects), ce qui le rend plus facile &agrave; comprendre, &agrave; tester et &agrave; faire &eacute;voluer.</p></li><li class="list__item" id="-vr9d5t_38"><p id="-vr9d5t_43"><span class="control" id="-vr9d5t_44">Outillage (Tooling) :</span> NgRx s'accompagne d'outils de d&eacute;veloppement exceptionnels (comme le Redux DevTools) qui vous permettent de voyager dans le temps, d'inspecter chaque changement d'&eacute;tat et de d&eacute;boguer votre application comme jamais auparavant.</p></li></ol><p id="-vr9d5t_34">Pr&eacute;parez-vous &agrave; changer de perspective. Nous n'allons plus simplement &quot;modifier&quot; l'&eacute;tat, nous allons &quot;d&eacute;crire&quot; les &eacute;v&eacute;nements qui m&egrave;nent &agrave; de nouveaux &eacute;tats.</p></section><section class="chapter"><h2 id="la-philosophie-de-ngrx" data-toc="la-philosophie-de-ngrx">La Philosophie de NgRx</h2><p id="-vr9d5t_45">Tout repose sur trois principes, inspir&eacute;s de Redux :</p><ol class="list _decimal" id="-vr9d5t_46" type="1"><li class="list__item" id="-vr9d5t_47"><p id="-vr9d5t_50"><span class="control" id="-vr9d5t_51">Source de v&eacute;rit&eacute; unique :</span> L'&eacute;tat de toute votre application est stock&eacute; dans un seul objet, &agrave; l'int&eacute;rieur d'un unique <span class="control" id="-vr9d5t_52">Store</span>.</p></li><li class="list__item" id="-vr9d5t_48"><p id="-vr9d5t_53"><span class="control" id="-vr9d5t_54">L'&eacute;tat est en lecture seule (immuable) :</span> La seule fa&ccedil;on de modifier l'&eacute;tat est d'&eacute;mettre une <span class="control" id="-vr9d5t_55">Action</span>, un objet d&eacute;crivant ce qui s'est pass&eacute;. On ne modifie jamais l'&eacute;tat existant, on en cr&eacute;e toujours un nouveau.</p></li><li class="list__item" id="-vr9d5t_49"><p id="-vr9d5t_56"><span class="control" id="-vr9d5t_57">Les changements sont effectu&eacute;s avec des fonctions pures :</span> Pour sp&eacute;cifier comment l'&eacute;tat est transform&eacute; par les actions, vous &eacute;crivez des <span class="control" id="-vr9d5t_58">Reducers</span>. Un reducer est une fonction pure qui prend l'&eacute;tat pr&eacute;c&eacute;dent et une action, et retourne l'&eacute;tat suivant.</p></li></ol></section><section class="chapter"><h2 id="les-acteurs-de-ngrx" data-toc="les-acteurs-de-ngrx">Les Acteurs de NgRx</h2><p id="-vr9d5t_59">Pour comprendre le flux NgRx, il faut conna&icirc;tre sa troupe d'acteurs. Chacun a un r&ocirc;le bien pr&eacute;cis.</p><div class="tabs" id="-vr9d5t_60" data-anchors="[-vr9d5t_61,-vr9d5t_62,-vr9d5t_63,-vr9d5t_64,-vr9d5t_65]"><div class="tabs__content" data-gtm="tab" id="-vr9d5t_61" data-title="Le Store"><p id="-vr9d5t_66">C'est le c&oelig;ur de NgRx. Un service injectable qui contient l'&eacute;tat global de l'application. On interagit avec lui de deux mani&egrave;res :</p><ul class="list _bullet" id="-vr9d5t_67"><li class="list__item" id="-vr9d5t_68"><p id="-vr9d5t_70"><code class="code" id="-vr9d5t_71">store.dispatch(action)</code>: pour envoyer une instruction de changement.</p></li><li class="list__item" id="-vr9d5t_69"><p id="-vr9d5t_72"><code class="code" id="-vr9d5t_73">store.select(selector)</code>: pour lire une partie de l'&eacute;tat.</p></li></ul></div><div class="tabs__content" data-gtm="tab" id="-vr9d5t_62" data-title="Les Actions"><p id="-vr9d5t_74">Les Actions sont le point de d&eacute;part de toute modification. Ce sont des <span class="control" id="-vr9d5t_76">messages</span>, des descriptions d'&eacute;v&eacute;nements. Elles disent <span class="emphasis" id="-vr9d5t_77">ce qui s'est pass&eacute;</span>, pas <span class="emphasis" id="-vr9d5t_78">comment</span> l'&eacute;tat doit changer.</p><div class="code-block" data-lang="ts" data-title="TypeScript">
// src/app/users/users.actions.ts
import {createAction, props} from '@ngrx/store';
import {User} from '../models/user.model';

// Décrit l'événement &quot;L'utilisateur veut charger la liste&quot;
export const loadUsers = createAction(
    '[Users Page] Load Users'
);

// Décrit l'événement &quot;La liste a été chargée avec succès&quot;
// et transporte la charge utile (payload)
export const loadUsersSuccess = createAction(
    '[Users API] Load Users Success',
    props&lt;{ users: User[] }&gt;()
);

// Décrit l'événement &quot;Le chargement a échoué&quot;
export const loadUsersFailure = createAction(
    '[Users API] Load Users Failure',
    props&lt;{ error: any }&gt;()
);
</div></div><div class="tabs__content" data-gtm="tab" id="-vr9d5t_63" data-title="Les Reducers"><p id="-vr9d5t_79">Le Reducer est le comptable. Il &eacute;coute toutes les actions qui passent. Quand il en reconna&icirc;t une, il prend l'&eacute;tat actuel, l'action, et <span class="control" id="-vr9d5t_82">calcule le nouvel &eacute;tat</span>. C'est une <span class="control" id="-vr9d5t_83">fonction pure</span>: pour les m&ecirc;mes entr&eacute;es, elle produit toujours la m&ecirc;me sortie, sans aucun effet de bord (pas d'appel API ici !).</p><p id="-vr9d5t_80">L' <span class="control" id="-vr9d5t_84">immutabilit&eacute;</span> est la r&egrave;gle d'or : on ne mute jamais <code class="code" id="-vr9d5t_85">state</code>, on utilise le spread operator (<code class="code" id="-vr9d5t_86">...</code>) pour cr&eacute;er une nouvelle copie.</p><div class="code-block" data-lang="ts" data-title="TypeScript">
// src/app/users/users.reducer.ts
import {createReducer, on} from '@ngrx/store';
import {loadUsers, loadUsersSuccess, loadUsersFailure}
    from './users.actions';

export interface UsersState {
    users: User[];
    isLoading: boolean;
    error: any;
}

export const initialState: UsersState = {
    users: [],
    isLoading: false,
    error: null
};

export const usersReducer = createReducer(
    initialState,
    // Quand l'action `loadUsers` est dispatchée...
    on(loadUsers, (state) =&gt; ({
        ...state, // ...on retourne un nouvel état
        isLoading: true
    })),

    // Quand l'action `loadUsersSuccess` arrive...
    on(loadUsersSuccess, (state, {users}) =&gt; ({
        ...state,
        users: users, // ...on met à jour les utilisateurs
        isLoading: false
    })),

    // Quand l'action `loadUsersFailure` arrive...
    on(loadUsersFailure, (state, {error}) =&gt; ({
        ...state,
        error: error,
        isLoading: false
    }))
);
</div></div><div class="tabs__content" data-gtm="tab" id="-vr9d5t_64" data-title="Les Effects"><p id="-vr9d5t_87">Mais alors, o&ugrave; fait-on les appels API ? Dans les <span class="control" id="-vr9d5t_90">Effects</span>! Un Effect est une classe qui &eacute;coute les actions, mais au lieu de modifier l'&eacute;tat, elle effectue des <span class="control" id="-vr9d5t_91">effets de bord</span> (t&acirc;ches asynchrones). Typiquement, un Effect va :</p><ol class="list _decimal" id="-vr9d5t_88" type="1"><li class="list__item" id="-vr9d5t_92"><p id="-vr9d5t_95">&Eacute;couter une action (ex: <code class="code" id="-vr9d5t_96">loadUsers</code>).</p></li><li class="list__item" id="-vr9d5t_93"><p id="-vr9d5t_97">Appeler un service (ex: <code class="code" id="-vr9d5t_98">HttpClient</code>).</p></li><li class="list__item" id="-vr9d5t_94"><p id="-vr9d5t_99">En cas de succ&egrave;s ou d'&eacute;chec, dispatcher une <span class="control" id="-vr9d5t_100">nouvelle action</span> (ex: <code class="code" id="-vr9d5t_101">loadUsersSuccess</code> ou <code class="code" id="-vr9d5t_102">loadUsersFailure</code>).</p></li></ol><div class="code-block" data-lang="ts" data-title="TypeScript">
// src/app/users/users.effects.ts
import {Injectable, inject} from '@angular/core';
import {Actions, createEffect, ofType} from '@ngrx/effects';
import {catchError, map, mergeMap} from 'rxjs/operators';
import {of} from 'rxjs';
import {UserService} from '../services/user.service';
import * as UsersActions from './users.actions';

@Injectable()
export class UsersEffects {
    private actions$ = inject(Actions);
    private userService = inject(UserService);

    loadUsers$ = createEffect(() =&gt;
        this.actions$.pipe(
            // Écoute seulement les actions de type `loadUsers`
            ofType(UsersActions.loadUsers),
            // Appelle le service
            mergeMap(() =&gt; this.userService.getUsers().pipe(
                // Si ça réussit, dispatche l'action de succès
                map(users =&gt; UsersActions.loadUsersSuccess({users})),
                // Si ça échoue, dispatche l'action d'échec
                catchError(error =&gt; of(UsersActions.loadUsersFailure({error})))
            ))
        )
    );
}
</div></div><div class="tabs__content" data-gtm="tab" id="-vr9d5t_65" data-title="Les Selectors"><p id="-vr9d5t_103">Les Selectors sont des fonctions pures qui permettent de <span class="control" id="-vr9d5t_105">lire des morceaux de l'&eacute;tat</span>. Ils sont optimis&eacute;s : NgRx met en cache le r&eacute;sultat (<code class="code" id="-vr9d5t_106">memoization</code>). Si l'&eacute;tat n'a pas chang&eacute;, le selector retourne la derni&egrave;re valeur calcul&eacute;e sans refaire le travail. C'est excellent pour la performance.</p><div class="code-block" data-lang="ts" data-title="TypeScript">
// src/app/users/users.selectors.ts
import {createFeatureSelector, createSelector} from '@ngrx/store';
import {UsersState} from './users.reducer';

// Sélectionne la &quot;tranche&quot; de l'état qui concerne les utilisateurs
export const selectUsersState =
    createFeatureSelector&lt;UsersState&gt;('users');

// Sélectionne la liste des utilisateurs à partir de la tranche
export const selectAllUsers = createSelector(
    selectUsersState,
    (state) =&gt; state.users
);

// Sélectionne l'état de chargement
export const selectUsersIsLoading = createSelector(
    selectUsersState,
    (state) =&gt; state.isLoading
);
</div></div></div></section><section class="chapter"><h2 id="le-flux-de-donn-es-unidirectionnel" data-toc="le-flux-de-donn-es-unidirectionnel">Le Flux de Donn&eacute;es Unidirectionnel</h2><p id="-vr9d5t_107">Voici le cycle de vie complet, qui est le c&oelig;ur de NgRx :</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="509px" preserveAspectRatio="none" style="width:945px;height:509px;background:#FFFFFF;" version="1.1" viewBox="0 0 945 509" width="945px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="112.7988"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="230.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="330.9727"/><rect fill="#FFFFFF" height="87.9316" style="stroke:#222222;stroke-width:1.0;" width="10" x="527.5" y="142.1094"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="709.5" y="171.4199"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#222222;stroke-width:1.0;" width="10" x="772.5" y="259.3516"/><line style="stroke:#222222;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="81.4883" y2="428.9043"/><line style="stroke:#222222;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="313.5" x2="313.5" y1="81.4883" y2="428.9043"/><line style="stroke:#222222;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="532" x2="532" y1="81.4883" y2="428.9043"/><line style="stroke:#222222;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="714.5" x2="714.5" y1="81.4883" y2="428.9043"/><line style="stroke:#222222;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="777.5" x2="777.5" y1="81.4883" y2="428.9043"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="5" y="78.5352">Composant</text><ellipse cx="47.5" cy="13.5" fill="#454645" rx="8" ry="8" style="stroke:#222222;stroke-width:0.5;"/><path d="M47.5,21.5 L47.5,48.5 M34.5,29.5 L60.5,29.5 M47.5,48.5 L34.5,63.5 M47.5,48.5 L60.5,63.5 " fill="none" style="stroke:#222222;stroke-width:0.5;"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="5" y="441.4395">Composant</text><ellipse cx="47.5" cy="452.8926" fill="#454645" rx="8" ry="8" style="stroke:#222222;stroke-width:0.5;"/><path d="M47.5,460.8926 L47.5,487.8926 M34.5,468.8926 L60.5,468.8926 M47.5,487.8926 L34.5,502.8926 M47.5,487.8926 L60.5,502.8926 " fill="none" style="stroke:#222222;stroke-width:0.5;"/><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="50" x="288.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="295.5" y="70.5352">Store</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="50" x="288.5" y="427.9043"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="295.5" y="448.4395">Store</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="59" x="503" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="510" y="70.5352">Effects</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="59" x="503" y="427.9043"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="510" y="448.4395">Effects</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="36" x="696.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="703.5" y="70.5352">API</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="36" x="696.5" y="427.9043"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="703.5" y="448.4395">API</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="70" x="742.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="749.5" y="70.5352">Reducer</text><rect fill="#FF6347" height="30.4883" rx="3.5" ry="3.5" style="stroke:#222222;stroke-width:1.5;" width="70" x="742.5" y="427.9043"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="749.5" y="448.4395">Reducer</text><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="112.7988"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="230.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="308.5" y="330.9727"/><rect fill="#FFFFFF" height="87.9316" style="stroke:#222222;stroke-width:1.0;" width="10" x="527.5" y="142.1094"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#222222;stroke-width:1.0;" width="10" x="709.5" y="171.4199"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#222222;stroke-width:1.0;" width="10" x="772.5" y="259.3516"/><polygon fill="#222222" points="296.5,108.7988,306.5,112.7988,296.5,116.7988,300.5,112.7988" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="47.5" x2="302.5" y1="112.7988" y2="112.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="54.5" y="108.0566">1. dispatch(loadUsers)</text><polygon fill="#222222" points="515.5,138.1094,525.5,142.1094,515.5,146.1094,519.5,142.1094" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="313.5" x2="521.5" y1="142.1094" y2="142.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="320.5" y="137.3672">2. notifie l'action</text><polygon fill="#222222" points="697.5,167.4199,707.5,171.4199,697.5,175.4199,701.5,171.4199" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="537.5" x2="703.5" y1="171.4199" y2="171.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="544.5" y="166.6777">3. appelle getUsers()</text><polygon fill="#222222" points="548.5,196.7305,538.5,200.7305,548.5,204.7305,544.5,200.7305" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="542.5" x2="713.5" y1="200.7305" y2="200.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="554.5" y="195.9883">4. retourne les donn&#233;es</text><polygon fill="#222222" points="329.5,226.041,319.5,230.041,329.5,234.041,325.5,230.041" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="323.5" x2="531.5" y1="230.041" y2="230.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="335.5" y="225.2988">5. dispatch(loadUsersSuccess)</text><polygon fill="#222222" points="760.5,255.3516,770.5,259.3516,760.5,263.3516,764.5,259.3516" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="313.5" x2="766.5" y1="259.3516" y2="259.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="320.5" y="254.6094">6. passe (&#233;tat, action)</text><line style="stroke:#222222;stroke-width:1.0;" x1="782.5" x2="824.5" y1="288.6621" y2="288.6621"/><line style="stroke:#222222;stroke-width:1.0;" x1="824.5" x2="824.5" y1="288.6621" y2="301.6621"/><line style="stroke:#222222;stroke-width:1.0;" x1="783.5" x2="824.5" y1="301.6621" y2="301.6621"/><polygon fill="#222222" points="793.5,297.6621,783.5,301.6621,793.5,305.6621,789.5,301.6621" style="stroke:#222222;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="789.5" y="283.9199">7. calcule le nouvel &#233;tat</text><polygon fill="#222222" points="329.5,326.9727,319.5,330.9727,329.5,334.9727,325.5,330.9727" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="323.5" x2="776.5" y1="330.9727" y2="330.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="335.5" y="326.2305">8. retourne le nouvel &#233;tat</text><polygon fill="#222222" points="58.5,356.2832,48.5,360.2832,58.5,364.2832,54.5,360.2832" style="stroke:#222222;stroke-width:1.0;"/><line style="stroke:#222222;stroke-width:1.0;" x1="52.5" x2="312.5" y1="360.2832" y2="360.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="64.5" y="355.541">9. notifie le changement (via selector)</text><path d="M52,376.7832 L52,409.7832 A3.5,3.5 0 0 0 55.5,413.2832 L238.5,413.2832 A3.5,3.5 0 0 0 242,409.7832 L242,383.2832 L232,373.2832 L55.5,373.2832 A3.5,3.5 0 0 0 52,376.7832 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><path d="M232,373.2832 L232,381.5332 A1.75,1.75 0 0 0 233.75,383.2832 L242,383.2832 L232,373.2832 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="58" y="390.8516">La vue est mise &#224; jour avec</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="58" y="406.1621">les nouvelles donn&#233;es.</text><!--SRC=[TL9BJiCm5Dpx58-oe4WGYVzdWLHG5aXTe4GSuE6yj0RN3hOJa11tOSivUZ6UNJu9b6oIU6OyC_RR27DQ47Jgpg49mZyeqw331NXwRCb8WXSnSSu-NLbj7MpkfqTCPB3kqhgAt12Ogfgcoj0wx0PTK58rRBGElhJFW-N3z8XN8J2wmUZABXhhMJq2z13_HFEp9OnAPb72oY6GrpN9u1EK3w79pNLQvlSGAAXg9Ra45a94DzYzW1BEOI-3Ila6WvoFjSNgrfFpsp6bwZ0GkvUHcZDrFmDZWweLWTwA16j4HJtczsSkyYZY72mxo02RXhGcc558-uzx1Z5i9Ev-kXncu2ZOrXcs8G-LDMRvJhvl5JNvLuEZTGtALahoNAIdol-qAbX-d463tXECb-y1mmwicct_KwqGnPVo90E9MhOw1kMZQJlIa3Q9dCzqfuCwGrRFeVYJBLtIEPpr3fr0pj7CUCRvKiUTGXviJN6UVgKLB25mQZOFOElLT4qHkfQ0V825uhhBDxZdM80TIH4FUXMjV-IP85D5U_e0]--></g></svg></div></section><section class="chapter"><h2 id="atelier-pratique-refactoriser-la-liste-d-utilisateurs-avec-ngrx" data-toc="atelier-pratique-refactoriser-la-liste-d-utilisateurs-avec-ngrx">Atelier Pratique : Refactoriser la Liste d'Utilisateurs avec NgRx</h2><p id="-vr9d5t_109"><span class="control" id="-vr9d5t_113">Objectif :</span> Prendre une application simple qui charge des utilisateurs via un service, et la refactoriser pour utiliser NgRx.</p><p id="-vr9d5t_110"><span class="control" id="-vr9d5t_114">Instructions :</span></p><ol class="list _decimal" id="-vr9d5t_111" type="1"><li class="list__item" id="-vr9d5t_115"><p id="-vr9d5t_123"><span class="control" id="-vr9d5t_124">Installez NgRx :</span> <code class="code" id="-vr9d5t_125">ng add @ngrx/store @ngrx/effects @ngrx/store-devtools</code></p></li><li class="list__item" id="-vr9d5t_116"><p id="-vr9d5t_126"><span class="control" id="-vr9d5t_127">Cr&eacute;ez un dossier <code class="code" id="-vr9d5t_130">store</code></span> dans <code class="code" id="-vr9d5t_128">src/app</code>. &Agrave; l'int&eacute;rieur, cr&eacute;ez un dossier <code class="code" id="-vr9d5t_129">users</code>.</p></li><li class="list__item" id="-vr9d5t_117"><p id="-vr9d5t_131"><span class="control" id="-vr9d5t_132">D&eacute;finissez vos Actions</span> dans <code class="code" id="-vr9d5t_133">users.actions.ts</code>: <code class="code" id="-vr9d5t_134">loadUsers</code>, <code class="code" id="-vr9d5t_135">loadUsersSuccess</code>, <code class="code" id="-vr9d5t_136">loadUsersFailure</code>.</p></li><li class="list__item" id="-vr9d5t_118"><p id="-vr9d5t_137"><span class="control" id="-vr9d5t_138">D&eacute;finissez votre State et votre Reducer</span> dans <code class="code" id="-vr9d5t_139">users.reducer.ts</code>.</p></li><li class="list__item" id="-vr9d5t_119"><p id="-vr9d5t_140"><span class="control" id="-vr9d5t_141">Cr&eacute;ez votre Effect</span> dans <code class="code" id="-vr9d5t_142">users.effects.ts</code> pour g&eacute;rer l'appel API.</p></li><li class="list__item" id="-vr9d5t_120"><p id="-vr9d5t_143"><span class="control" id="-vr9d5t_144">Cr&eacute;ez vos Selectors</span> dans <code class="code" id="-vr9d5t_145">users.selectors.ts</code>.</p></li><li class="list__item" id="-vr9d5t_121"><p id="-vr9d5t_146"><span class="control" id="-vr9d5t_147">Configurez le Store</span> dans votre <code class="code" id="-vr9d5t_148">app.config.ts</code> (pour une application Standalone) en important les providers.</p></li><li class="list__item" id="-vr9d5t_122"><p id="-vr9d5t_149"><span class="control" id="-vr9d5t_151">Modifiez votre <code class="code" id="-vr9d5t_152">UserListComponent</code></span>:</p><ul class="list _bullet" id="-vr9d5t_150"><li class="list__item" id="-vr9d5t_153"><p id="-vr9d5t_156">Injectez le <code class="code" id="-vr9d5t_157">Store</code>.</p></li><li class="list__item" id="-vr9d5t_154"><p id="-vr9d5t_158">Dans <code class="code" id="-vr9d5t_159">ngOnInit</code>, dispatchez l'action <code class="code" id="-vr9d5t_160">loadUsers</code>.</p></li><li class="list__item" id="-vr9d5t_155"><p id="-vr9d5t_161">Utilisez les selectors pour r&eacute;cup&eacute;rer les donn&eacute;es (<code class="code" id="-vr9d5t_162">users$ = this.store.select(...)</code>) et les consommer dans le template avec le pipe <code class="code" id="-vr9d5t_163">async</code>.</p></li></ul></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h3 id="correction-exercice-2-2" data-toc="correction-exercice-2-2">Correction exercice 2.2</h3></div><div class="collapse__content"><section class="procedure-steps" id="-vr9d5t_164"><p id="-vr9d5t_165">Voici l'impl&eacute;mentation compl&egrave;te du refactoring vers NgRx.</p><p id="-vr9d5t_166"><span class="control" id="-vr9d5t_174">Pr&eacute;requis : Un service <code class="code" id="-vr9d5t_175">UserService</code> qui fait l'appel API.</span></p><div class="code-block" data-lang="ts">
// src/app/services/user.service.ts
import {Injectable, inject} from '@angular/core';
import {HttpClient} from '@angular/common/http';
import {Observable} from 'rxjs';
import {User} from '../models/user.model'; // Assurez-vous d'avoir ce modèle

@Injectable({providedIn: 'root'})
export class UserService {
    private http = inject(HttpClient);

    getUsers(): Observable&lt;User[]&gt; {
        return this.http.get&lt;User[]&gt;('https://jsonplaceholder.typicode.com/users');
    }
}
</div><p id="-vr9d5t_168"><span class="control" id="-vr9d5t_176">1. Les fichiers NgRx (dans <code class="code" id="-vr9d5t_177">src/app/store/users/</code>)</span></p><ul class="list _bullet" id="-vr9d5t_169"><li class="list__item" id="-vr9d5t_178"><p id="-vr9d5t_182"><code class="code" id="-vr9d5t_183">users.actions.ts</code>: (Identique &agrave; l'exemple ci-dessus)</p></li><li class="list__item" id="-vr9d5t_179"><p id="-vr9d5t_184"><code class="code" id="-vr9d5t_185">users.reducer.ts</code>: (Identique &agrave; l'exemple ci-dessus)</p></li><li class="list__item" id="-vr9d5t_180"><p id="-vr9d5t_186"><code class="code" id="-vr9d5t_187">users.effects.ts</code>: (Identique &agrave; l'exemple ci-dessus)</p></li><li class="list__item" id="-vr9d5t_181"><p id="-vr9d5t_188"><code class="code" id="-vr9d5t_189">users.selectors.ts</code>: (Identique &agrave; l'exemple ci-dessus)</p></li></ul><p id="-vr9d5t_170"><span class="control" id="-vr9d5t_190">2. Configuration dans <code class="code" id="-vr9d5t_191">app.config.ts</code></span></p><div class="code-block" data-lang="ts">
// src/app/app.config.ts
import {ApplicationConfig, isDevMode} from '@angular/core';
import {provideHttpClient} from '@angular/common/http';
import {provideStore} from '@ngrx/store';
import {provideStoreDevtools} from '@ngrx/store-devtools';
import {provideEffects} from '@ngrx/effects';

import {usersReducer} from './store/users/users.reducer';
import {UsersEffects} from './store/users/users.effects';

export const appConfig: ApplicationConfig = {
    providers: [
        provideHttpClient(),
        // Enregistre le store global
        provideStore({users: usersReducer}),
        // Enregistre les effects
        provideEffects([UsersEffects]),
        // Active les DevTools seulement en mode développement
        provideStoreDevtools({
            maxAge: 25,
            logOnly: !isDevMode(),
        }),
    ],
};
</div><p id="-vr9d5t_172"><span class="control" id="-vr9d5t_192">3. Le composant refactoris&eacute;</span></p><div class="code-block" data-lang="ts">
// src/app/components/user-list/user-list.component.ts
import {Component, OnInit, inject} from '@angular/core';
import {CommonModule} from '@angular/common';
import {Store} from '@ngrx/store';

import * as UsersActions from '../../store/users/users.actions';
import {selectAllUsers, selectUsersIsLoading}
    from '../../store/users/users.selectors';

@Component({
    selector: 'app-user-list',
    standalone: true,
    imports: [CommonModule],
    template: `
    &lt;h2&gt;Liste des Utilisateurs (avec NgRx)&lt;/h2&gt;

    &lt;div *ngIf=&quot;isLoading$ | async&quot;&gt;Chargement...&lt;/div&gt;

    &lt;ul&gt;
      &lt;li *ngFor=&quot;let user of users$ | async&quot;&gt;
        {{ user.name }} ({{ user.email }})
      &lt;/li&gt;
    &lt;/ul&gt;
  `
})
export class UserListComponent implements OnInit {
    private store = inject(Store);

    // On sélectionne les données du store via les selectors
    users$ = this.store.select(selectAllUsers);
    isLoading$ = this.store.select(selectUsersIsLoading);

    ngOnInit(): void {
        // On dispatche l'action pour déclencher le chargement
        this.store.dispatch(UsersActions.loadUsers());
    }
}
</div><ol class="list _decimal"></ol></section></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><ol class="list _decimal" id="-vr9d5t_193" type="1"><li class="list__item" id="-vr9d5t_194"><p id="-vr9d5t_199"><span class="control" id="-vr9d5t_200">Lequel de ces principes n'appartient PAS &agrave; la philosophie de NgRx/Redux ?</span> a. L'&eacute;tat est en lecture seule. b. Les composants peuvent modifier directement l'&eacute;tat pour plus de simplicit&eacute;. c. Il y a une source de v&eacute;rit&eacute; unique (le Store). d. Les changements d'&eacute;tat sont faits par des fonctions pures (Reducers).</p></li><li class="list__item" id="-vr9d5t_195"><p id="-vr9d5t_201"><span class="control" id="-vr9d5t_202">Expliquez le r&ocirc;le d'un <code class="code" id="-vr9d5t_203">Effect</code> et pourquoi il ne modifie jamais directement l'&eacute;tat.</span></p></li><li class="list__item" id="-vr9d5t_196"><p id="-vr9d5t_204"><span class="control" id="-vr9d5t_205">Quel est le r&ocirc;le principal d'un <code class="code" id="-vr9d5t_206">Reducer</code>?</span> a. G&eacute;rer les appels API et autres effets de bord. b. Calculer un nouvel &eacute;tat en r&eacute;ponse &agrave; une action. c. S&eacute;lectionner des donn&eacute;es du store pour les composants. d. Dispatcher des actions.</p></li><li class="list__item" id="-vr9d5t_197"><p id="-vr9d5t_207"><span class="control" id="-vr9d5t_208">Pourquoi les <code class="code" id="-vr9d5t_209">Selectors</code> sont-ils consid&eacute;r&eacute;s comme performants ?</span></p></li><li class="list__item" id="-vr9d5t_198"><p id="-vr9d5t_210"><span class="control" id="-vr9d5t_211">Dans le flux de donn&eacute;es NgRx, quelle est la premi&egrave;re chose qu'un composant fait pour initier un changement d'&eacute;tat ( comme le chargement de donn&eacute;es) ?</span> a. Il appelle une m&eacute;thode sur un <code class="code" id="-vr9d5t_212">Reducer</code>. b. Il s'abonne &agrave; un <code class="code" id="-vr9d5t_213">Effect</code>. c. Il dispatche une <code class="code" id="-vr9d5t_214">Action</code> au <code class="code" id="-vr9d5t_215">Store</code>. d. Il modifie directement une variable dans le <code class="code" id="-vr9d5t_216">Store</code>.</p></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-vr9d5t_217">Vous venez de faire vos premiers pas dans le monde structur&eacute; de NgRx. Nous avons vu que malgr&eacute; un code initial plus important, cette approche apporte une clart&eacute; et une pr&eacute;visibilit&eacute; sans &eacute;gales pour les applications complexes. Vous avez appris &agrave; s&eacute;parer les pr&eacute;occupations : les <span class="control" id="-vr9d5t_219">Actions</span> d&eacute;crivent les &eacute;v&eacute;nements, les <span class="control" id="-vr9d5t_220">Reducers</span> calculent l'&eacute;tat, les * <span class="emphasis" id="-vr9d5t_221">Effects</span>* g&egrave;rent les effets de bord, et les <span class="control" id="-vr9d5t_222">Selectors</span> lisent les donn&eacute;es.</p><p id="-vr9d5t_218">NgRx est un outil puissant, et le ma&icirc;triser demande de la pratique. Ne soyez pas d&eacute;courag&eacute; par le nombre de fichiers ; voyez-le comme un plan bien organis&eacute;. Dans les prochains modules, nous verrons comment cette gestion d'&eacute;tat centralis&eacute;e interagit avec des patrons de conception de composants pour cr&eacute;er des architectures encore plus propres et performantes. Vous verrez comment le patron &quot;Container/Presentational&quot; s'accorde parfaitement avec la philosophie de NgRx.</p></section><div class="last-modified">12 octobre 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="002-00-state-management.html" class="navigation-links__prev">Module 2 : L'essentiel - Strat&eacute;gies de Gestion d'&Eacute;tat (State Management)</a><a href="003-00-better-components.html" class="navigation-links__next">Module 3 : L'essentiel - B&acirc;tir des Composants Sains et Performants</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>