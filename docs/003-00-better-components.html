<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-14T10:01:35.564564"><title>Module 3 : L'essentiel - B&acirc;tir des Composants Sains et Performants | Angular avancé</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction","level":0,"title":"Introduction","anchor":"#introduction"},{"id":"le-patron-container-presentational-ou-smart-dumb-components","level":0,"title":"Le Patron \"Container/Presentational\" (ou \"Smart/Dumb Components\")","anchor":"#le-patron-container-presentational-ou-smart-dumb-components"},{"id":"optimisation-des-performances-change-detection-onpush","level":0,"title":"Optimisation des Performances : Change Detection OnPush","anchor":"#optimisation-des-performances-change-detection-onpush"},{"id":"optimisation-des-listes-trackby","level":0,"title":"Optimisation des Listes : trackBy","anchor":"#optimisation-des-listes-trackby"},{"id":"exercice-3-1-cr-ation-d-une-product-list-optimis-e","level":0,"title":"Exercice 3.1 : Création d\u0027une \"Product List\" optimisée","anchor":"#exercice-3-1-cr-ation-d-une-product-list-optimis-e"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Module 3 : L'essentiel - B&acirc;tir des Composants Sains et Performants | Angular avancé"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Angular avancé Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/003-00-better-components.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Module 3 : L'essentiel - B&acirc;tir des Composants Sains et Performants | Angular avancé"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/003-00-better-components.html#webpage",
    "url": "writerside-documentation/003-00-better-components.html",
    "name": "Module 3 : L'essentiel - B&acirc;tir des Composants Sains et Performants | Angular avancé",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Angular avancé Help"
}</script><!-- End Schema.org --></head><body data-id="003-00-better-components" data-main-title="Module 3 : L'essentiel - Bâtir des Composants Sains et Performants" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Angular avancé  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="003-00-better-components" id="003-00-better-components.md">Module 3 : L'essentiel - Bâtir des Composants Sains et Performants</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs p&eacute;dagogiques</h2><p id="w0nviz_11">&Agrave; la fin de ce module, vous serez capable de :</p><ul class="list _bullet" id="w0nviz_12"><li class="list__item" id="w0nviz_13"><p id="w0nviz_17"><span class="control" id="w0nviz_18">Distinguer et appliquer</span> le patron de conception &quot;Container/Presentational&quot; pour mieux organiser votre code.</p></li><li class="list__item" id="w0nviz_14"><p id="w0nviz_19"><span class="control" id="w0nviz_20">Ma&icirc;triser</span> la strat&eacute;gie de d&eacute;tection de changement <code class="code" id="w0nviz_21">OnPush</code> pour optimiser radicalement les performances de vos composants.</p></li><li class="list__item" id="w0nviz_15"><p id="w0nviz_22"><span class="control" id="w0nviz_23">Comprendre</span> et <span class="control" id="w0nviz_24">mettre en &oelig;uvre</span> le principe d'immutabilit&eacute;, pr&eacute;requis indispensable pour <code class="code" id="w0nviz_25">OnPush</code>.</p></li><li class="list__item" id="w0nviz_16"><p id="w0nviz_26"><span class="control" id="w0nviz_27">Optimiser</span> le rendu des listes dynamiques avec la fonction <code class="code" id="w0nviz_28">trackBy</code> pour une exp&eacute;rience utilisateur plus fluide.</p></li></ul></section><section class="chapter"><h2 id="introduction" data-toc="introduction">Introduction</h2><p id="w0nviz_29">Vous savez maintenant comment g&eacute;rer l'&eacute;tat de votre application de mani&egrave;re centralis&eacute;e. C'est une immense avanc&eacute;e. Mais comment les composants doivent-ils consommer et afficher cet &eacute;tat ?</p><p id="w0nviz_30">Imaginez un composant <code class="code" id="w0nviz_32">UserProfileComponent</code>. Il doit r&eacute;cup&eacute;rer les donn&eacute;es de l'utilisateur, afficher son nom et sa photo, contenir un formulaire pour modifier son profil, appeler le service pour sauvegarder les changements, et afficher des messages de succ&egrave;s ou d'erreur. Ce composant est un &quot;homme &agrave; tout faire&quot;. Il devient rapidement un monolithe de plusieurs centaines de lignes, difficile &agrave; lire, quasi impossible &agrave; r&eacute;utiliser et un v&eacute;ritable cauchemar &agrave; tester.</p><p id="w0nviz_31">Dans ce module, nous allons apprendre &agrave; d&eacute;construire ces monolithes. Nous allons d&eacute;couvrir des patrons de conception qui s&eacute;parent les responsabilit&eacute;s : la logique d'un c&ocirc;t&eacute;, l'affichage de l'autre. C'est le secret pour &eacute;crire des composants plus petits, plus cibl&eacute;s, plus r&eacute;utilisables et, surtout, beaucoup plus performants. Nous allons transformer nos composants en une &eacute;quipe d'experts sp&eacute;cialis&eacute;s plut&ocirc;t qu'en un seul employ&eacute; surmen&eacute;.</p></section><section class="chapter"><h2 id="le-patron-container-presentational-ou-smart-dumb-components" data-toc="le-patron-container-presentational-ou-smart-dumb-components">Le Patron &quot;Container/Presentational&quot; (ou &quot;Smart/Dumb Components&quot;)</h2><p id="w0nviz_33">C'est l'un des patrons de conception les plus importants pour une architecture Angular saine. L'id&eacute;e est de diviser vos composants en deux cat&eacute;gories distinctes.</p><div class="tabs" id="w0nviz_34" data-anchors="[w0nviz_37,w0nviz_38]"><div class="tabs__content" data-gtm="tab" id="w0nviz_37" data-title="Container / Smart Component"><p id="w0nviz_39"><span class="control" id="w0nviz_43">Le Cerveau / Le Manager</span></p><p id="w0nviz_40">Ce composant conna&icirc;t le &quot;monde ext&eacute;rieur&quot;. Ses responsabilit&eacute;s sont :</p><ul class="list _bullet" id="w0nviz_41"><li class="list__item" id="w0nviz_44"><p id="w0nviz_48"><span class="control" id="w0nviz_49">Se connecter aux sources de donn&eacute;es :</span> Injecter des services, se connecter au Store NgRx.</p></li><li class="list__item" id="w0nviz_45"><p id="w0nviz_50"><span class="control" id="w0nviz_51">G&eacute;rer la logique m&eacute;tier :</span> D&eacute;clencher des actions, appeler des m&eacute;thodes de service.</p></li><li class="list__item" id="w0nviz_46"><p id="w0nviz_52"><span class="control" id="w0nviz_53">Passer les donn&eacute;es</span> aux composants de pr&eacute;sentation via des <code class="code" id="w0nviz_54">@Input()</code>.</p></li><li class="list__item" id="w0nviz_47"><p id="w0nviz_55"><span class="control" id="w0nviz_56">&Eacute;couter les &eacute;v&eacute;nements</span> remont&eacute;s par les composants de pr&eacute;sentation via <code class="code" id="w0nviz_57">@Output()</code>.</p></li></ul><p id="w0nviz_42">Il ne se pr&eacute;occupe pas de savoir si un bouton est bleu ou si un titre est en <code class="code" id="w0nviz_58">&lt;h2&gt;</code>. Il g&egrave;re le <span class="emphasis" id="w0nviz_59">quoi</span> et le <span class="emphasis" id="w0nviz_60">pourquoi</span>.</p></div><div class="tabs__content" data-gtm="tab" id="w0nviz_38" data-title="Presentational / Dumb Component"><p>**Les Mains / L'Employ&eacute; Sp&eacute;cialis&eacute;** </p><p id="w0nviz_61">Ce composant est &quot;stupide&quot; et isol&eacute; du reste de l'application. Il ne sait pas d'o&ugrave; viennent les donn&eacute;es. Ses responsabilit&eacute;s sont :</p><ul class="list _bullet" id="w0nviz_62"><li class="list__item" id="w0nviz_64"><p id="w0nviz_68"><span class="control" id="w0nviz_69">Recevoir des donn&eacute;es</span> via des <code class="code" id="w0nviz_70">@Input()</code>.</p></li><li class="list__item" id="w0nviz_65"><p id="w0nviz_71"><span class="control" id="w0nviz_72">Afficher ces donn&eacute;es</span> dans un template.</p></li><li class="list__item" id="w0nviz_66"><p id="w0nviz_73"><span class="control" id="w0nviz_74">&Eacute;mettre des &eacute;v&eacute;nements</span> via des <code class="code" id="w0nviz_75">@Output()</code> lorsque l'utilisateur interagit avec lui (clic, saisie...).</p></li><li class="list__item" id="w0nviz_67"><p id="w0nviz_76"><span class="control" id="w0nviz_77">&Ecirc;tre auto-suffisant et r&eacute;utilisable :</span> Vous pourriez le d&eacute;placer dans n'importe quelle autre application, lui donner les bons <code class="code" id="w0nviz_78">@Input()</code>, et il fonctionnerait.</p></li></ul><p id="w0nviz_63">Il se concentre exclusivement sur le <span class="emphasis" id="w0nviz_79">comment</span> les choses sont affich&eacute;es.</p></div></div><p id="w0nviz_35"><span class="control" id="w0nviz_80">Le flux de donn&eacute;es est simple :</span></p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="228px" preserveAspectRatio="none" style="width:676px;height:228px;background:#FFFFFF;" version="1.1" viewBox="0 0 676 228" width="676px" zoomAndPan="magnify"><defs/><g><!--cluster Application--><g id="cluster_Application"><path d="M95.92,6 L176.92,6 A5.25,5.25 0 0 1 180.42,9.5 L187.42,28.4883 L477.92,28.4883 A3.5,3.5 0 0 1 481.42,31.9883 L481.42,218.08 A3.5,3.5 0 0 1 477.92,221.58 L95.92,221.58 A3.5,3.5 0 0 1 92.42,218.08 L92.42,9.5 A3.5,3.5 0 0 1 95.92,6 " fill="none" style="stroke:#696969;stroke-width:1.0;"/><line style="stroke:#696969;stroke-width:1.0;" x1="92.42" x2="187.42" y1="28.4883" y2="28.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82" x="96.42" y="21.5352">Application</text></g><!--entity Container--><g id="elem_Container"><rect fill="#F1F1F1" height="36.4883" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="277.92" y="41"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="287.92" y="64.5352">Container Component</text></g><!--entity Presentational--><g id="elem_Presentational"><rect fill="#F1F1F1" height="36.4883" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="203" x="262.92" y="164.59"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="272.92" y="188.1252">Presentational Component</text></g><!--entity Service--><g id="elem_Service"><path d="M108.92,170.09 C108.92,160.09 168.42,160.09 168.42,160.09 C168.42,160.09 227.92,160.09 227.92,170.09 L227.92,195.5783 C227.92,205.5783 168.42,205.5783 168.42,205.5783 C168.42,205.5783 108.92,205.5783 108.92,195.5783 L108.92,170.09 " fill="#00FFFF" style="stroke:#454645;stroke-width:0.5;"/><path d="M108.92,170.09 C108.92,180.09 168.42,180.09 168.42,180.09 C168.42,180.09 227.92,180.09 227.92,170.09 " fill="none" style="stroke:#454645;stroke-width:0.5;"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="118.92" y="197.6252">Service / Store</text></g><g id="elem_GMN10"><path d="M496.92,34.78 L496.92,55.58 L451.26,59.58 L496.92,63.58 L496.92,83.7116 A3.5,3.5 0 0 0 500.42,87.2116 L652.42,87.2116 A3.5,3.5 0 0 0 655.92,83.7116 L655.92,41.28 L645.92,31.28 L500.42,31.28 A3.5,3.5 0 0 0 496.92,34.78 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><path d="M645.92,31.28 L645.92,39.53 A1.75,1.75 0 0 0 647.67,41.28 L655.92,41.28 L645.92,31.28 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="502.92" y="48.8484">&#160;</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="502.92" y="64.1589">- Conna&#238;t les services</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="502.92" y="79.4695">- Contient la logique</text></g><g id="elem_GMN13"><path d="M500.92,150.71 L500.92,178.58 L466.19,182.58 L500.92,186.58 L500.92,214.9522 A3.5,3.5 0 0 0 504.42,218.4522 L666.42,218.4522 A3.5,3.5 0 0 0 669.92,214.9522 L669.92,157.21 L659.92,147.21 L504.42,147.21 A3.5,3.5 0 0 0 500.92,150.71 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><path d="M659.92,147.21 L659.92,155.46 A1.75,1.75 0 0 0 661.67,157.21 L669.92,157.21 L659.92,147.21 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="506.92" y="164.7784">&#160;</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="506.92" y="180.0889">- Re&#231;oit des donn&#233;es</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="506.92" y="195.3995">- Emet des &#233;v&#233;nements</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="506.92" y="210.71">- Est r&#233;utilisable</text></g><!--link Container to Service--><g id="link_Container_Service"><path d="M277.56,53.58 C217.59,53.58 148.58,53.58 148.58,53.58 C148.58,53.58 148.58,116.55 148.58,153.73 " fill="none" id="Container-to-Service" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="148.58,159.73,152.58,150.73,148.58,154.73,144.58,150.73,148.58,159.73" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="7" y="50.1484">1. R&#233;cup&#232;re les donn&#233;es</text></g><!--link Service to Container--><g id="link_Service_Container"><path d="M188.25,159.67 C188.25,125.5 188.25,65.58 188.25,65.58 C188.25,65.58 227.16,65.58 271.62,65.58 " fill="none" id="Service-to-Container" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="277.62,65.58,268.62,61.58,272.62,65.58,268.62,69.58,277.62,65.58" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="47.25" y="81.5084">2. Fournit les donn&#233;es</text></g><!--link Container to Presentational--><g id="link_Container_Presentational"><path d="M335.58,77.75 C335.58,101.05 335.58,134.85 335.58,158.21 " fill="none" id="Container-to-Presentational" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="335.58,164.21,339.58,155.21,335.58,159.21,331.58,155.21,335.58,164.21" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="179.58" y="117.5484">3. `@Input() [data]="..."`</text></g><!--link Presentational to Container--><g id="link_Presentational_Container"><path d="M393.25,164.33 C393.25,141.03 393.25,107.24 393.25,83.88 " fill="none" id="Presentational-to-Container" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="393.25,77.88,389.25,86.88,393.25,82.88,397.25,86.88,393.25,77.88" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="185.25" y="134.6784">4. `@Output() (userAction)="..."`</text></g><!--SRC=[xLRTJXf15BwVfpZb2Y_O0YvODscZehHQZGRK6sFYi7k0YSFCTcOMOngVf-McBx4lrhEio8fejAtfZH38Sivtlk_yp0_lt11726FHCrmvnkobK34tV0HIA7JNCO8sRgWBZb2FOgrGkQwxbWW6GyVLG29ZCGyl-G2Xj1d7KeJS2QrAy9tTHS1PIol7YTb0QsOy1sxXpbu47ncqz33buN8XuhwJiOWxtkEMrBjenY94U0zTfmsMClIjZTqmDa-XycbcXm1g7dJIIPZ4wK-38D52f9LA9sZP35IXW7bq07KFsZenIhZx-FiI2rK4iEh1nSQkYXDNNe6pBE_pZoNFyqeNR06xAEXdaOU9oqFBYKMp6MRObHa1KzhHJCHWw43t2srbbUo7ukclF5cRrsHpknDPmoK7gGVYMu8C05K46TaYvMBVAz31z8Uc7aJ57bHWPuIvBPsCqucYPQRSr6uTc7IIE265vJrvJmnWWvwJ4H4NbjmMBQo1qOcAMbfg0-tfgm2mGnxfAw46qEVIOi7JoQDCri2rWdtJ67sLi_aDl-at2husDUGHLnUfEoh4VT6dZy8jRI8qERYvdhsNW3zJwl4Nv8Hy1lKKFSSzpVfy_HnvF1JXfK9heLPiiBr5Rekn81JjMQ1NaVmstRcvo9HP7rHsKnIWRoT24TCXCoD_CDFcgh_sbEvSuNR-IvFn5fJlpeNbijNg0jKJiiiAeqKjtFMZDUqq6lK_9v_klENKQvJrjlyYwcUrYuTqPZwY-O3dXUNqCYfkNgjR8NcDbg_6BYLE3rlxg4AZxV-50ct11F_DxdZUhD-k-BSh_hzUyKUIxeEJWtqOex4aHXEgL-khNgrURXi1Xw63UXLgZS1V3ne-j7Qwnv01LbZvOFSOB4s6PXO9wupe9TCkiJq-vj19gDuH1d0OezhR_Zepm8uQ2wDLbYZREpsO0vf-POiApDO1pU7qW6rZdoVIKKIe8_fd4S39SRloWUtJJaXe2mJGDxGAYDTS1z3k_0O0]--></g></svg></div></section><section class="chapter"><h2 id="optimisation-des-performances-change-detection-onpush" data-toc="optimisation-des-performances-change-detection-onpush">Optimisation des Performances : Change Detection <code class="code" id="w0nviz_87">OnPush</code></h2><p id="w0nviz_82">Par d&eacute;faut, Angular est tr&egrave;s prudent. D&egrave;s qu'un &eacute;v&eacute;nement se produit dans votre application (un clic, un appel HTTP termin&eacute;, un <code class="code" id="w0nviz_88">setTimeout</code>), il v&eacute;rifie <span class="control" id="w0nviz_89">tous</span> les composants, du haut vers le bas, pour voir si quelque chose a chang&eacute; et s'il faut mettre &agrave; jour le DOM. C'est la strat&eacute;gie <code class="code" id="w0nviz_90">Default</code>. C'est s&ucirc;r, mais potentiellement lent dans une grande application.</p><p id="w0nviz_83">La strat&eacute;gie <span class="control" id="w0nviz_91"><code class="code" id="w0nviz_93">OnPush</code></span> change la donne. Un composant <code class="code" id="w0nviz_92">OnPush</code> ne sera v&eacute;rifi&eacute; que si l'une de ces conditions est remplie :</p><ol class="list _decimal" id="w0nviz_84" type="1"><li class="list__item" id="w0nviz_94"><p id="w0nviz_97"><span class="control" id="w0nviz_98">Une r&eacute;f&eacute;rence de ses <code class="code" id="w0nviz_99">@Input()</code> a chang&eacute;.</span></p></li><li class="list__item" id="w0nviz_95"><p id="w0nviz_100">Un &eacute;v&eacute;nement (comme un <code class="code" id="w0nviz_101">click</code>) a &eacute;t&eacute; d&eacute;clench&eacute; <span class="control" id="w0nviz_102">depuis le composant lui-m&ecirc;me ou l'un de ses enfants</span>.</p></li><li class="list__item" id="w0nviz_96"><p id="w0nviz_103">On demande manuellement une v&eacute;rification (via <code class="code" id="w0nviz_104">ChangeDetectorRef.markForCheck()</code>).</p></li></ol><aside class="prompt" data-type="warning" data-title="" id="w0nviz_85"><p>**La R&egrave;gle d'Or de l'Immutabilit&eacute;** </p><p id="w0nviz_105">Le point 1 est crucial. Si vous passez un objet &agrave; un composant <code class="code" id="w0nviz_108">OnPush</code> et que vous modifiez une de ses propri&eacute;t&eacute;s sans changer l'objet lui-m&ecirc;me, <span class="control" id="w0nviz_109">Angular ne verra pas le changement !</span> La r&eacute;f&eacute;rence de l'objet est la m&ecirc;me.</p><p id="w0nviz_106">Pour d&eacute;clencher la d&eacute;tection de changement, vous devez <span class="control" id="w0nviz_110">cr&eacute;er un nouvel objet ou un nouvel tableau</span>. C'est le principe de l'immutabilit&eacute;, et c'est pourquoi les <code class="code" id="w0nviz_111">Reducers</code> NgRx utilisent toujours le spread operator (<code class="code" id="w0nviz_112">...</code>).</p><div class="code-block" data-lang="ts">
// DANS LE CONTAINER

// MAUVAIS : Ne déclenchera pas OnPush sur le composant enfant
this.user.name = 'Nouveau Nom';

// BON : Crée un nouvel objet, change la référence, déclenche OnPush
this.user = {...this.user, name: 'Nouveau Nom'}; 
</div></aside><p id="w0nviz_86">Les composants de pr&eacute;sentation (&quot;Dumb&quot;) sont les candidats parfaits pour passer en <code class="code" id="w0nviz_113">OnPush</code>, car ils ne d&eacute;pendent que de leurs <code class="code" id="w0nviz_114">@Input()</code>.</p></section><section class="chapter"><h2 id="optimisation-des-listes-trackby" data-toc="optimisation-des-listes-trackby">Optimisation des Listes : <code class="code" id="w0nviz_121">trackBy</code></h2><p id="w0nviz_116">Lorsque vous utilisez <code class="code" id="w0nviz_122">@for</code> (ou l'ancien <code class="code" id="w0nviz_123">*ngFor</code>) pour afficher une liste et que cette liste change, Angular doit d&eacute;terminer comment mettre &agrave; jour le DOM. Par d&eacute;faut, il n'a aucun moyen de savoir si les &eacute;l&eacute;ments ont simplement &eacute;t&eacute; r&eacute;organis&eacute;s ou si ce sont de tout nouveaux &eacute;l&eacute;ments. Pour &ecirc;tre s&ucirc;r, il peut &ecirc;tre amen&eacute; &agrave; d&eacute;truire tous les n&oelig;uds DOM de la liste et &agrave; les recr&eacute;er.</p><p id="w0nviz_117">C'est lent, et cela peut avoir des effets de bord ind&eacute;sirables (perte du focus, r&eacute;initialisation d'animations CSS...).</p><p id="w0nviz_118">La fonction <code class="code" id="w0nviz_124">trackBy</code> est la solution. Vous fournissez une fonction qui donne &agrave; Angular un <span class="control" id="w0nviz_125">identifiant unique et stable</span> pour chaque &eacute;l&eacute;ment de la liste. Ainsi, Angular peut suivre chaque &eacute;l&eacute;ment individuellement.</p><div class="code-block" data-lang="ts">
// Dans le composant
@Component({
    // ...
    template: `
    &lt;!-- On fournit la fonction trackBy à la directive --&gt;
    &lt;div *ngFor=&quot;let item of items; trackBy: trackById&quot;&gt;
      {{ item.name }}
    &lt;/div&gt;

    &lt;!-- Nouvelle syntaxe avec @for --&gt;
    @for (item of items; track item.id) {
      &lt;div&gt;{{ item.name }}&lt;/div&gt;
    }
  `
})
export class MyListComponent {
    items = [{id: 1, name: 'A'}, {id: 2, name: 'B'}];

    // La fonction reçoit l'index et l'item
    // Elle doit retourner une valeur unique et stable (string ou number)
    trackById(index: number, item: { id: number; name: string }): number {
        return item.id;
    }
}
</div><p id="w0nviz_120">Maintenant, si vous m&eacute;langez la liste, Angular ne fera que r&eacute;organiser les &eacute;l&eacute;ments dans le DOM au lieu de tout d&eacute;truire et recr&eacute;er.</p></section><section class="chapter"><h2 id="exercice-3-1-cr-ation-d-une-product-list-optimis-e" data-toc="exercice-3-1-cr-ation-d-une-product-list-optimis-e">Exercice 3.1 : Cr&eacute;ation d'une &quot;Product List&quot; optimis&eacute;e</h2><p id="w0nviz_126"><span class="control" id="w0nviz_130">Objectif :</span> Mettre en pratique les trois concepts vus dans ce module.</p><p id="w0nviz_127"><span class="control" id="w0nviz_131">Instructions :</span></p><ol class="list _decimal" id="w0nviz_128" type="1"><li class="list__item" id="w0nviz_132"><p id="w0nviz_134"><span class="control" id="w0nviz_136">Cr&eacute;ez un <code class="code" id="w0nviz_137">ProductCardComponent</code> (Presentational) :</span></p><ul class="list _bullet" id="w0nviz_135"><li class="list__item" id="w0nviz_138"><p id="w0nviz_141">Il doit avoir un <code class="code" id="w0nviz_142">@Input() product</code> pour recevoir les donn&eacute;es d'un produit (<code class="code" id="w0nviz_143">{id, name, price}</code>).</p></li><li class="list__item" id="w0nviz_139"><p id="w0nviz_144">Il doit avoir un <code class="code" id="w0nviz_145">@Output() addToCart</code> qui &eacute;met l'ID du produit quand on clique sur un bouton &quot;Ajouter&quot;.</p></li><li class="list__item" id="w0nviz_140"><p id="w0nviz_146"><span class="control" id="w0nviz_147">Passez ce composant en strat&eacute;gie <code class="code" id="w0nviz_148">OnPush</code></span>.</p></li></ul></li><li class="list__item" id="w0nviz_133"><p id="w0nviz_149"><span class="control" id="w0nviz_151">Cr&eacute;ez un <code class="code" id="w0nviz_152">ProductListComponent</code> (Container) :</span></p><ul class="list _bullet" id="w0nviz_150"><li class="list__item" id="w0nviz_153"><p id="w0nviz_158">Il doit simuler la r&eacute;cup&eacute;ration d'une liste de produits dans <code class="code" id="w0nviz_159">ngOnInit</code> (un simple tableau d'objets).</p></li><li class="list__item" id="w0nviz_154"><p id="w0nviz_160">Il doit afficher une liste de <code class="code" id="w0nviz_161">ProductCardComponent</code> en utilisant <code class="code" id="w0nviz_162">@for</code>.</p></li><li class="list__item" id="w0nviz_155"><p id="w0nviz_163"><span class="control" id="w0nviz_164">Utilisez <code class="code" id="w0nviz_165">trackBy</code> (ou <code class="code" id="w0nviz_166">@for...track</code>)</span> pour optimiser le rendu de la liste.</p></li><li class="list__item" id="w0nviz_156"><p id="w0nviz_167">Il doit avoir une m&eacute;thode <code class="code" id="w0nviz_168">onAddToCart(productId: number)</code> qui affiche un <code class="code" id="w0nviz_169">console.log</code>.</p></li><li class="list__item" id="w0nviz_157"><p id="w0nviz_170">Ajoutez un bouton &quot;Mettre &agrave; jour le premier produit&quot; qui modifie le prix du premier produit de la liste <span class="control" id="w0nviz_171">de mani&egrave;re immuable</span> pour que le changement soit visible dans le <code class="code" id="w0nviz_172">ProductCardComponent</code> <code class="code" id="w0nviz_173">OnPush</code>.</p></li></ul></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h3 id="correction-exercice-3-1" data-toc="correction-exercice-3-1">Correction exercice 3.1</h3></div><div class="collapse__content"><section class="procedure-steps" id="w0nviz_174"><p id="w0nviz_175">Voici une solution compl&egrave;te qui combine les trois patrons.</p><p id="w0nviz_176"><span class="control" id="w0nviz_180">1. <code class="code" id="w0nviz_181">product-card.component.ts</code> (Le composant de pr&eacute;sentation)</span></p><div class="code-block" data-lang="ts">
// src/app/product-card/product-card.component.ts
import {
    Component, Input, Output, EventEmitter,
    ChangeDetectionStrategy
} from '@angular/core';
import {CommonModule} from '@angular/common';

export interface Product {
    id: number;
    name: string;
    price: number;
}

@Component({
    selector: 'app-product-card',
    standalone: true,
    imports: [CommonModule],
    template: `
    &lt;div class=&quot;card&quot; *ngIf=&quot;product&quot;&gt;
      &lt;h4&gt;{{ product.name }}&lt;/h4&gt;
      &lt;p&gt;{{ product.price | currency }}&lt;/p&gt;
      &lt;button (click)=&quot;onAddToCart()&quot;&gt;Ajouter au panier&lt;/button&gt;
    &lt;/div&gt;
  `,
    styles: [`.card { border: 1px solid grey; padding: 1rem; margin: 0.5rem; }`],
    // LA LIGNE MAGIQUE POUR LA PERFORMANCE !
    changeDetection: ChangeDetectionStrategy.OnPush
})
export class ProductCardComponent {
    // Ce composant ne connaît que ses inputs et outputs.
    @Input() product!: Product;
    @Output() addToCart = new EventEmitter&lt;number&gt;();

    onAddToCart(): void {
        this.addToCart.emit(this.product.id);
    }
}
</div><p id="w0nviz_178"><span class="control" id="w0nviz_182">2. <code class="code" id="w0nviz_183">product-list.component.ts</code> (Le composant conteneur)</span></p><div class="code-block" data-lang="ts">
// src/app/product-list/product-list.component.ts
import {Component, OnInit} from '@angular/core';
import {CommonModule} from '@angular/common';
import {ProductCardComponent, Product}
    from '../product-card/product-card.component';

@Component({
    selector: 'app-product-list',
    standalone: true,
    imports: [CommonModule, ProductCardComponent],
    template: `
    &lt;h2&gt;Nos Produits&lt;/h2&gt;
    &lt;button (click)=&quot;updateFirstProduct()&quot;&gt;Mettre à jour le prix du 1er&lt;/button&gt;
    
    &lt;div class=&quot;list-container&quot;&gt;
      &lt;!-- Nouvelle syntaxe avec @for et track --&gt;
      @for (product of products; track product.id) {
        &lt;app-product-card 
          [product]=&quot;product&quot;
          (addToCart)=&quot;onAddToCart($event)&quot;&gt;
        &lt;/app-product-card&gt;
      }
    &lt;/div&gt;
  `
})
export class ProductListComponent implements OnInit {
    products: Product[] = [];

    ngOnInit(): void {
        // Simule une récupération de données
        this.products = [
            {id: 101, name: 'Super Casque Audio', price: 150},
            {id: 102, name: 'Clavier Mécanique', price: 95},
            {id: 103, name: 'Souris Gamer', price: 60}
        ];
    }

    onAddToCart(productId: number): void {
        console.log(`Le produit avec l'ID ${productId} a été ajouté au panier.`);
    }

    updateFirstProduct(): void {
        if (this.products.length === 0) return;

        // Approche immuable : on crée un NOUVEAU tableau
        this.products = this.products.map((p, index) =&gt; {
            // Si c'est le premier produit, on retourne un NOUVEL objet
            if (index === 0) {
                return {...p, price: p.price + 10};
            }
            // Sinon, on retourne l'objet original
            return p;
        });

        console.log('Liste des produits mise à jour.', this.products);
    }
}
</div><ol class="list _decimal"></ol></section></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><ol class="list _decimal" id="w0nviz_184" type="1"><li class="list__item" id="w0nviz_185"><p id="w0nviz_190"><span class="control" id="w0nviz_191">Laquelle de ces responsabilit&eacute;s N'APPARTIENT PAS &agrave; un composant de pr&eacute;sentation (&quot;Dumb Component&quot;) ?</span> a. Recevoir des donn&eacute;es via <code class="code" id="w0nviz_192">@Input()</code>. b. Injecter un service pour r&eacute;cup&eacute;rer des donn&eacute;es. c. &Eacute;mettre des &eacute;v&eacute;nements via <code class="code" id="w0nviz_193">@Output()</code>. d. Afficher des donn&eacute;es dans un template.</p></li><li class="list__item" id="w0nviz_186"><p id="w0nviz_194"><span class="control" id="w0nviz_195">Expliquez avec vos propres mots pourquoi l'immutabilit&eacute; est une condition n&eacute;cessaire pour faire fonctionner correctement un composant qui utilise la strat&eacute;gie de d&eacute;tection de changement <code class="code" id="w0nviz_196">OnPush</code>.</span></p></li><li class="list__item" id="w0nviz_187"><p id="w0nviz_197"><span class="control" id="w0nviz_198">Quel est le principal b&eacute;n&eacute;fice de l'utilisation de <code class="code" id="w0nviz_200">trackBy</code> (ou <code class="code" id="w0nviz_201">@for...track</code>) dans une liste ?</span> a. Cela acc&eacute;l&egrave;re le chargement initial des donn&eacute;es de la liste. b. Cela emp&ecirc;che Angular de d&eacute;truire et recr&eacute;er inutilement des &eacute;l&eacute;ments du DOM lorsque la liste est mise &agrave; jour. c. Cela s&eacute;curise les donn&eacute;es affich&eacute;es dans la liste. d. Cela applique automatiquement la strat&eacute;gie <code class="code" id="w0nviz_199">OnPush</code> &agrave; chaque &eacute;l&eacute;ment.</p></li><li class="list__item" id="w0nviz_188"><p id="w0nviz_202"><span class="control" id="w0nviz_203">Dans le patron Container/Presentational, comment un composant &quot;Container&quot; est-il inform&eacute; d'une action de l' utilisateur qui a eu lieu dans un composant &quot;Presentational&quot; (par exemple, un clic sur un bouton) ?</span></p></li><li class="list__item" id="w0nviz_189"><p id="w0nviz_204"><span class="control" id="w0nviz_205">Vous avez un composant <code class="code" id="w0nviz_210">OnPush</code>. Lequel de ces &eacute;v&eacute;nements NE d&eacute;clenchera PAS sa d&eacute;tection de changement ?</span> a. L'utilisateur clique sur un bouton &agrave; l'int&eacute;rieur du template du composant. b. Un de ses <code class="code" id="w0nviz_206">@Input()</code> re&ccedil;oit un nouveau tableau. c. Son composant parent modifie une propri&eacute;t&eacute; d'un objet qui a &eacute;t&eacute; pass&eacute; en <code class="code" id="w0nviz_207">@Input()</code> au composant <code class="code" id="w0nviz_208">OnPush</code>. d. <code class="code" id="w0nviz_209">ChangeDetectorRef.markForCheck()</code> est appel&eacute;.</p></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="w0nviz_211">F&eacute;licitations ! Vous venez d'acqu&eacute;rir des comp&eacute;tences fondamentales en architecture de composants. En s&eacute;parant la logique (Container) de l'affichage (Presentational), vous rendez votre code plus propre, plus testable et plus r&eacute;utilisable. En appliquant la strat&eacute;gie <code class="code" id="w0nviz_213">OnPush</code> et l'immutabilit&eacute;, vous prenez le contr&ocirc;le de la d&eacute;tection de changement pour des performances optimales. Enfin, avec <code class="code" id="w0nviz_214">trackBy</code>, vous vous assurez que m&ecirc;me les listes les plus longues et dynamiques restent fluides.</p><p id="w0nviz_212">Ces optimisations se situent au niveau des composants (micro-optimisations). Dans la partie &quot;Pour aller plus loin&quot;, nous allons changer d'&eacute;chelle et nous int&eacute;resser &agrave; une optimisation au niveau de l'application enti&egrave;re : le <span class="control" id="w0nviz_215">Lazy Loading</span>, ou chargement paresseux. C'est la technique qui va radicalement r&eacute;duire le temps de chargement initial de votre application.</p></section><div class="last-modified">12 octobre 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="002-01-ngrx.html" class="navigation-links__prev">Module 2 : Pour aller plus loin - Introduction &agrave; NgRx (L'approche Redux)</a><a href="003-01-lazy-loading.html" class="navigation-links__next">Module 3 : Pour aller plus loin - Architecturer pour la Vitesse : Le Lazy Loading des Routes</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>